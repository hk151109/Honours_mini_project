{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/heemi/Downloads/enviro-meter/app/api/predict/route.ts"],"sourcesContent":["function generateRecommendations(formData: any, emissionScore: number): string[] {\n  const recommendations: string[] = []\n\n  // Energy usage\n  if (formData.heatingEnergy !== \"electricity\" || formData.energyEfficiency === \"no\") {\n    recommendations.push(\"Improve energy efficiency at home (insulation, LED bulbs, etc.)\")\n  }\n\n  // Transport\n  if (formData.transport === \"private\" || formData.vehicleMonthlyKm > 200) {\n    recommendations.push(\"Use public transport, cycle, or walk more often\")\n  }\n\n  // Air travel\n  if (formData.airTravelFrequency !== \"never\" && formData.airTravelFrequency !== \"rarely\") {\n    recommendations.push(\"Limit air travel when possible\")\n  }\n\n  // Diet\n  if (formData.diet === \"omnivore\") {\n    recommendations.push(\"Consider a more plant-based diet to reduce carbon footprint\")\n  }\n\n  // Waste and recycling\n  if (!formData.recycling || formData.recycling.length === 0) {\n    recommendations.push(\"Recycle consistently to reduce waste\")\n  }\n\n  if (formData.wasteBagWeeklyCount > 3 || formData.newClothesMonthly > 5) {\n    recommendations.push(\"Reduce unnecessary consumption and purchases\")\n  }\n\n  // Digital usage\n  if (formData.tvPcHoursDaily > 6 || formData.internetHoursDaily > 8) {\n    recommendations.push(\"Limit screen time or use energy-efficient devices\")\n  }\n\n  // Fallback if no recommendations\n  if (recommendations.length === 0) {\n    recommendations.push(\"Maintain your sustainable lifestyle!\")\n  }\n\n  // Optional: add a note if emission is high\n  if (emissionScore > 1000) {\n    recommendations.push(\"Your carbon footprint is high â€” take immediate action to reduce emissions!\")\n  }\n\n  return recommendations\n}\n\nexport async function POST(request: Request) {\n  try {\n    const formData = await request.json()\n\n    // Map frontend values to dataset-compatible values\n    const showerMap: Record<string, string> = {\n      \"rarely\": \"less frequently\",\n      \"sometimes\": \"frequently\",\n      \"often\": \"often\",\n      \"very_often\": \"daily\",\n    }\n\n    const socialActivityMap: Record<string, string> = {\n      \"never\": \"rarely\",\n      \"sometimes\": \"sometimes\",\n      \"often\": \"often\",\n    }\n\n    const airTravelMap: Record<string, string> = {\n      \"never\": \"never\",\n      \"rarely\": \"rarely\",\n      \"sometimes\": \"frequently\",\n      \"often\": \"frequently\",\n    }\n\n    const heatingEnergyMap: Record<string, string> = {\n      \"coal\": \"coal\",\n      \"wood\": \"wood\",\n      \"natural_gas\": \"natural gas\",\n      \"electricity\": \"electricity\",\n    }\n\n    const INR_TO_USD = 0.011;\n\n    const payload = {\n      \"Body Type\": formData.bodyType, // Must match dataset: \"overweight\", \"obese\", \"normal\", \"medium\"\n      \"Sex\": formData.sex,\n      \"Diet\": formData.diet,\n      \"How Often Shower\": showerMap[formData.showerFrequency] || \"daily\",\n      \"Heating Energy Source\": heatingEnergyMap[formData.heatingEnergy] || \"electricity\",\n      \"Transport\": formData.transport,\n      \"Vehicle Type\": formData.vehicleType || \"None\",\n      \"Social Activity\": socialActivityMap[formData.socialActivity] || \"often\",\n      \"Monthly Grocery Bill\": Number(formData.monthlyGroceryBill) * INR_TO_USD,\n      \"Frequency of Traveling by Air\": airTravelMap[formData.airTravelFrequency] || \"rarely\",\n      \"Vehicle Monthly Distance Km\": Number(formData.vehicleMonthlyKm),\n      \"Waste Bag Size\": formData.wasteBagSize,\n      \"Waste Bag Weekly Count\": Number(formData.wasteBagWeeklyCount),\n      \"How Long TV PC Daily Hour\": Number(formData.tvPcHoursDaily),\n      \"How Many New Clothes Monthly\": Number(formData.newClothesMonthly),\n      \"How Long Internet Daily Hour\": Number(formData.internetHoursDaily),\n      \"Energy efficiency\": formData.energyEfficiency,\n      \"Recycling\": JSON.stringify(formData.recycling.length\n        ? formData.recycling.map((v: string) => v.charAt(0).toUpperCase() + v.slice(1))\n        : [\"Metal\"]),\n      \"Cooking_With\": JSON.stringify(formData.cookingWith.length\n        ? formData.cookingWith.map((v: string) => v.charAt(0).toUpperCase() + v.slice(1))\n        : [\"Stove\"]),\n    }\n\n    const response = await fetch(\"http://127.0.0.1:5000/predict\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    })\n\n    const result = await response.json()\n\n    if (!response.ok) {\n      console.error(\"Flask error:\", result)\n      throw new Error(\"Flask API returned an error\")\n    }\n\n    const recommendations = generateRecommendations(formData, result.predicted_carbon_emission)\n\n    return Response.json({\n      emissionScore: result.predicted_carbon_emission,\n      status: result.predicted_carbon_emission < 50\n        ? \"Low\"\n        : result.predicted_carbon_emission < 100\n        ? \"Moderate\"\n        : \"High\",\n      recommendations,\n    })\n  } catch (error) {\n    console.error(\"Prediction error:\", error)\n    return Response.json({ error: \"Failed to fetch prediction from backend\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}